\doxysection{consensus\+\_\+state.\+h}
\hypertarget{consensus__state_8h_source}{}\label{consensus__state_8h_source}\index{include/neo/consensus/consensus\_state.h@{include/neo/consensus/consensus\_state.h}}
\mbox{\hyperlink{consensus__state_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{uint256_8h}{neo/io/uint256.h}}>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{neo3__transaction_8h}{neo/network/p2p/payloads/neo3\_transaction.h}}>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceneo_1_1consensus}{neo::consensus}}}
\DoxyCodeLine{00013\ \{}
\DoxyCodeLine{00017\ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805}{ConsensusPhase}}}
\DoxyCodeLine{00018\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805a4f2a91e15af2631ff9424564b8a45fb2}{Initial}},}
\DoxyCodeLine{00020\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805a074de7e7c226d5c60f8af14c20725352}{Primary}},}
\DoxyCodeLine{00021\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805a3500ba09d0538297440ca620c9dd46bf}{Backup}},}
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805abd6598ad25882fac85535d16e7e2f305}{RequestSent}},}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805ac0061f0229809369b6525fea6a9c5dea}{RequestReceived}},}
\DoxyCodeLine{00024\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805a51a5293d3af2049e564db11edd4efdaf}{SignatureSent}},}
\DoxyCodeLine{00025\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805a1694bbbd8c3e377a63b2020183699911}{BlockSent}},}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805aec27f40ee956b0fc3b2b35c9e5e7ac85}{ViewChanging}}}
\DoxyCodeLine{00027\ \};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state}{ConsensusState}}}
\DoxyCodeLine{00033\ \{}
\DoxyCodeLine{00034\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{mutable}\ std::mutex\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_aca3dc164465299f9570d52bb990c0771}{mutex\_}};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//\ Basic\ state}}
\DoxyCodeLine{00038\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a9dbf94cb63b95e638b3864e48b0c0200}{view\_number\_}}\{0\};}
\DoxyCodeLine{00039\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a4ba649c9a791250c0b9b00b5161b6b71}{block\_index\_}}\{0\};}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805}{ConsensusPhase}}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a1f8b9f91b78835fbf66a9b9d1291f171}{phase\_}}\{\mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805a4f2a91e15af2631ff9424564b8a45fb2}{ConsensusPhase::Initial}}\};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ Current\ proposal}}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{classneo_1_1io_1_1_u_int256}{io::UInt256}}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_aba1502d599e20e7499f501ccb6240c32}{prepare\_request\_hash\_}};}
\DoxyCodeLine{00044\ \ \ \ \ std::vector<network::p2p::payloads::Neo3Transaction>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a6ed2bf65ebeb4a53fd78a88aac7563c8}{proposed\_transactions\_}};}
\DoxyCodeLine{00045\ \ \ \ \ std::chrono::system\_clock::time\_point\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_af5b8cc4552ff05097df89e09a50c2e08}{timestamp\_}};}
\DoxyCodeLine{00046\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a0d48a3dbdbdb3b2b6e9edf95de6ff504}{nonce\_}}\{0\};}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ Tracking\ responses}}
\DoxyCodeLine{00049\ \ \ \ \ std::unordered\_map<uint32\_t,\ io::UInt256>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a7f6caf4f8d560585dc556ec95cf65a22}{prepare\_responses\_}};\ \ \textcolor{comment}{//\ validator\_index\ -\/>\ hash}}
\DoxyCodeLine{00050\ \ \ \ \ std::unordered\_map<uint32\_t,\ std::vector<uint8\_t>>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a88a0b859980b249caecdac544b1676c4}{commits\_}};\ \ \ \textcolor{comment}{//\ validator\_index\ -\/>\ signature}}
\DoxyCodeLine{00051\ \ \ \ \ std::unordered\_set<uint32\_t>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a983803f3848a134b36110e6869a0356c}{view\_changes\_}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ validator\ indices\ requesting\ view\ change}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ Transaction\ pool}}
\DoxyCodeLine{00054\ \ \ \ \ std::unordered\_map<io::UInt256,\ network::p2p::payloads::Neo3Transaction>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_ab7d035815bc99b0865c1c7d224d6ba8d}{transaction\_pool\_}};}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00060\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a30a3a4fff96b7c5113cff354df72d76b}{GetViewNumber}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a2a4250d51666f192206c51c5121bdc1c}{SetViewNumber}}(uint32\_t\ view);}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00070\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_af146794c34ad091ffc4f36e13be9a64d}{GetBlockIndex}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_ad150e031815580bbdfb5ce025a102961}{SetBlockIndex}}(uint32\_t\ index);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805}{ConsensusPhase}}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_abf208467e8981fd038e354793695ec97}{GetPhase}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_af677a1595b8c38578c731ba345fe16ed}{SetPhase}}(\mbox{\hyperlink{namespaceneo_1_1consensus_a1f31011f0d70db613209aeab1a60b805}{ConsensusPhase}}\ phase);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{classneo_1_1io_1_1_u_int256}{io::UInt256}}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a16766f08114802ec64cf61bb3e489c03}{GetPrepareRequestHash}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a5103b5d7b0b7dba05c4513fc5fe3a56c}{SetPrepareRequest}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classneo_1_1io_1_1_u_int256}{io::UInt256}}\&\ hash,\ \textcolor{keyword}{const}\ std::vector<network::p2p::payloads::Neo3Transaction>\&\ txs,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::chrono::system\_clock::time\_point\ timestamp,\ uint64\_t\ nonce);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_aeaa4bfd2945af0c7499edcdb42d83a5d}{AddPrepareResponse}}(uint32\_t\ validator\_index,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classneo_1_1io_1_1_u_int256}{io::UInt256}}\&\ hash);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a95e9734a08f7b892aeac33bee7acbcc4}{GetPrepareResponseCount}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a9787642b0c57e53129083de60e0f242c}{HasPrepareResponse}}(uint32\_t\ validator\_index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_ac830c87570231bb50a1ae9fcec4f8b06}{AddCommit}}(uint32\_t\ validator\_index,\ \textcolor{keyword}{const}\ std::vector<uint8\_t>\&\ signature);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a05034ecbf087f0d591c302fce2689535}{GetCommitCount}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a125d1fe5fcd1aeb09011979e21417e92}{HasCommit}}(uint32\_t\ validator\_index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_ad6293484809b5b47c7debe61151880f0}{AddViewChange}}(uint32\_t\ validator\_index);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_adb2a6124af286345603d5ba9730e5af4}{GetViewChangeCount}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_afe672afb85510fc6d92aea9e1d36fcc2}{AddTransaction}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classneo_1_1network_1_1p2p_1_1payloads_1_1_neo3_transaction}{network::p2p::payloads::Neo3Transaction}}\&\ tx);}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_ac5f0c74a643b639cf97b46fba58cf42b}{RemoveTransaction}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classneo_1_1io_1_1_u_int256}{io::UInt256}}\&\ hash);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00157\ \ \ \ \ std::vector<network::p2p::payloads::Neo3Transaction>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a20f1cd66fa950ac760ffadcdfaeded9d}{GetTransactionsForBlock}}(\textcolor{keywordtype}{size\_t}\ max\_count)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00162\ \ \ \ \ std::chrono::system\_clock::time\_point\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a5e169d8408aee633ea1b0b80c9dff190}{GetTimestamp}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00167\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a1565aa1625bf1455bed95d2a60c51077}{GetNonce}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00172\ \ \ \ \ std::vector<network::p2p::payloads::Neo3Transaction>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a42db6db33f3b9640a03f7aad7f7b620b}{GetTransactions}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00177\ \ \ \ \ std::unordered\_map<uint32\_t,\ std::vector<uint8\_t>>\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a39ca6770ce374ada98c65fb168d4e4e4}{GetCommits}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_a2772ef77072818ce35074578ca15839d}{Reset}}();}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classneo_1_1consensus_1_1_consensus_state_ae71eabbf41368507e0fe6ed772abebe2}{ResetForViewChange}}();}
\DoxyCodeLine{00188\ \};}
\DoxyCodeLine{00189\ \}\ \ \textcolor{comment}{//\ namespace\ neo::consensus}}

\end{DoxyCode}
